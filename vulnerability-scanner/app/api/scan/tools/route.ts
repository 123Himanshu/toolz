/**
 * Scanner Tools API - List available security tools
 */

import { NextResponse } from 'next/server';

const AVAILABLE_TOOLS = {
  network: [
    { id: 'nmap', name: 'Nmap', description: 'Network mapper and port scanner', status: 'active' },
    { id: 'masscan', name: 'Masscan', description: 'Fast port scanner', status: 'active' },
    { id: 'rustscan', name: 'RustScan', description: 'Modern port scanner', status: 'active' },
    { id: 'naabu', name: 'Naabu', description: 'Fast port scanner by ProjectDiscovery', status: 'active' }
  ],
  web: [
    { id: 'nuclei', name: 'Nuclei', description: 'Template-based vulnerability scanner', status: 'active' },
    { id: 'nikto', name: 'Nikto', description: 'Web server scanner', status: 'active' },
    { id: 'wapiti', name: 'Wapiti', description: 'Web application vulnerability scanner', status: 'active' }
  ],
  system: [
    { id: 'trivy', name: 'Trivy', description: 'Container and filesystem scanner', status: 'active' },
    { id: 'openvas', name: 'OpenVAS', description: 'Enterprise vulnerability scanner', status: 'active' }
  ],
  recon: [
    { id: 'subfinder', name: 'Subfinder', description: 'Subdomain discovery tool', status: 'active' },
    { id: 'httpx', name: 'HTTPx', description: 'HTTP toolkit', status: 'active' },
    { id: 'passive', name: 'Passive Recon', description: 'OSINT gathering', status: 'active' }
  ]
};

export async function GET() {
  const allTools = [
    ...AVAILABLE_TOOLS.network,
    ...AVAILABLE_TOOLS.web,
    ...AVAILABLE_TOOLS.system,
    ...AVAILABLE_TOOLS.recon
  ];

  return NextResponse.json({
    success: true,
    tools: allTools,
    categories: Object.keys(AVAILABLE_TOOLS),
    byCategory: AVAILABLE_TOOLS,
    total: allTools.length
  });
}
