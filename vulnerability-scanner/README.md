# Vulnerability Scanner - Phase 1

## ğŸ¯ SIH 2025 - Problem Statement 25234

**Organization:** National Technical Research Organisation (NTRO)  
**Category:** Software  
**Phase:** Phase 1 - Vulnerability Scanning & Data Collection

---

## âœ… What's Built

### Complete Phase 1 Implementation

This is a **fully functional vulnerability scanning platform** with:

- âœ… **Dashboard** - Overview of all scans with real-time updates
- âœ… **New Scan Page** - Configure and start scans with tool selection
- âœ… **Scan Progress** - Real-time progress tracking
- âœ… **Results Display** - View scan results and export data
- âœ… **Backend API** - Scan orchestration and Docker integration
- âœ… **12 Security Tools** - All integrated and ready to use

---

## ğŸ› ï¸ Technology Stack

**Frontend & Backend:**
- Next.js 14 (App Router)
- TypeScript
- Tailwind CSS
- React Hooks

**Security Tools (Docker):**
- Network: Nmap, Masscan, RustScan, Naabu, Zmap
- Web: ZAP, Nuclei, Wapiti, Nikto, Jaeles
- System: Trivy, OpenVAS

---

## ğŸš€ Quick Start

### Prerequisites
- Node.js 18+ installed
- Docker installed and running
- security-scanner Docker image built

### 1. Install Dependencies
```bash
cd vulnerability-scanner
pnpm install
```

### 2. Start Development Server
```bash
pnpm dev
```

### 3. Access Application
```
http://localhost:3000
```

### 4. Verify Docker Image
```bash
docker images security-scanner
```

---

## ğŸ“± Features

### 1. Dashboard
- **Stats Cards:** Total scans, Running, Completed, Failed
- **Recent Scans Table:** View all scans with status
- **Real-time Updates:** Auto-refresh every 5 seconds
- **Quick Actions:** Start new scan, view details

### 2. New Scan Configuration
**Target Input:**
- Single IP
- IP Range (CIDR)
- Domain
- Subdomain List

**Scan Types:**
- Passive (Reconnaissance only)
- Active (Tool-based scanning)
- Both (Combined approach)

**Tool Selection (Categorized):**

**Network Enumeration:**
- Nmap - Network scanner
- Masscan - High-speed IP scanner
- RustScan - Fast port scanner
- Naabu - Port scanning tool
- Zmap - Internet-scale scanner

**Web Application Scanning:**
- ZAP - OWASP Zed Attack Proxy
- Nuclei - Template-based scanner
- Wapiti - Web application scanner
- Nikto - Web server scanner
- Jaeles - Signature-based scanner

**Host & System Scanning:**
- Trivy - Container/IaC scanner
- OpenVAS - Vulnerability scanner

**Scan Configuration:**
- Intensity: Low / Medium / High
- Rate: Slow / Moderate / Fast
- Depth: Shallow / Normal / Deep
- Timeout: Configurable (60-3600 seconds)

### 3. Scan Progress
- Real-time tool-by-tool progress
- Status indicators (Queued/Running/Completed/Failed)
- Progress percentage
- Live updates every 3 seconds

### 4. Results Display
- **Progress Tab:** Tool execution status
- **Results Tab:** Parsed scan results
- **Raw Output Tab:** JSON output
- **Export:** Download results as JSON
- **Scan Info:** ID, timestamps, configuration

---

## ğŸ—ï¸ Project Structure

```
vulnerability-scanner/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ api/
â”‚   â”‚   â””â”€â”€ scan/
â”‚   â”‚       â””â”€â”€ route.ts          # Backend API
â”‚   â”œâ”€â”€ scan/
â”‚   â”‚   â”œâ”€â”€ new/
â”‚   â”‚   â”‚   â””â”€â”€ page.tsx          # New scan page
â”‚   â”‚   â””â”€â”€ [id]/
â”‚   â”‚       â””â”€â”€ page.tsx          # Scan details page
â”‚   â”œâ”€â”€ page.tsx                  # Dashboard
â”‚   â”œâ”€â”€ layout.tsx                # Root layout
â”‚   â””â”€â”€ globals.css               # Global styles
â”œâ”€â”€ public/                       # Static assets
â”œâ”€â”€ package.json
â”œâ”€â”€ tsconfig.json
â”œâ”€â”€ tailwind.config.ts
â””â”€â”€ next.config.js
```

---

## ğŸ”Œ API Endpoints

### POST /api/scan
Start a new scan

**Request Body:**
```json
{
  "target": "example.com",
  "targetType": "domain",
  "scanType": "both",
  "tools": {
    "network": ["nmap", "naabu"],
    "web": ["zap", "nuclei"],
    "system": ["trivy"]
  },
  "config": {
    "intensity": "medium",
    "rate": "moderate",
    "depth": "normal",
    "timeout": 300
  }
}
```

**Response:**
```json
{
  "success": true,
  "scanId": "uuid",
  "message": "Scan started successfully"
}
```

### GET /api/scan
List all scans

**Response:**
```json
[
  {
    "id": "uuid",
    "target": "example.com",
    "status": "running",
    "progress": {...},
    "results": {...},
    "startedAt": "2025-11-22T...",
    "completedAt": null
  }
]
```

### GET /api/scan?scanId=xxx
Get specific scan details

**Response:**
```json
{
  "id": "uuid",
  "target": "example.com",
  "scanType": "both",
  "status": "completed",
  "progress": {
    "nmap": "completed",
    "nuclei": "completed",
    "zap": "completed"
  },
  "results": {
    "nmap": {...},
    "nuclei": {...},
    "zap": {...}
  },
  "startedAt": "2025-11-22T...",
  "completedAt": "2025-11-22T..."
}
```

---

## ğŸ³ Docker Integration

The application integrates with the `security-scanner` Docker image that contains all scanning tools.

### Tool Execution
Each tool is executed via Docker:

```typescript
const command = `docker run --rm security-scanner python -c "
from nuclei_scanner import NucleiScanner
import json
scanner = NucleiScanner(use_docker=False)
result = scanner.quick_scan('${target}')
print(json.dumps(result))
"`;
```

### Supported Tools
All 12 tools from the security-scanner image are integrated:
- Network scanners (5)
- Web scanners (5)
- System scanners (2)

---

## ğŸ“Š Scan Flow

1. **User configures scan** on New Scan page
2. **Submit** triggers POST /api/scan
3. **Backend generates** scan ID and queues scan
4. **Tools execute** sequentially in Docker
5. **Progress updates** stored in scan record
6. **Results collected** as tools complete
7. **User views** progress and results in real-time

---

## ğŸ¨ UI/UX Features

- **Dark Theme:** Professional cybersecurity aesthetic
- **Gradient Backgrounds:** Modern visual design
- **Responsive:** Works on desktop, tablet, mobile
- **Real-time Updates:** Auto-refresh for live data
- **Loading States:** Clear feedback during operations
- **Status Indicators:** Color-coded status icons
- **Categorized Tools:** Organized by function
- **Export Functionality:** Download results

---

## ğŸ”§ Configuration

### Environment Variables (Optional)
Create `.env.local`:

```env
# API Configuration
NEXT_PUBLIC_API_URL=http://localhost:3000

# Docker Configuration
DOCKER_IMAGE=security-scanner:latest

# Scan Defaults
DEFAULT_TIMEOUT=300
MAX_CONCURRENT_SCANS=5
```

---

## ğŸ“ˆ Performance

- **Scan Execution:** Parallel tool execution (configurable)
- **Real-time Updates:** 3-5 second refresh intervals
- **Memory Usage:** In-memory storage (replace with DB for production)
- **Concurrent Scans:** Supports multiple simultaneous scans

---

## ğŸš§ Known Limitations

1. **In-Memory Storage:** Scans are lost on server restart
   - **Solution:** Implement PostgreSQL database

2. **Polling Updates:** Uses HTTP polling instead of WebSocket
   - **Solution:** Implement Socket.io for real-time updates

3. **No Authentication:** No user authentication/authorization
   - **Solution:** Add NextAuth.js or similar

4. **Basic Error Handling:** Limited error recovery
   - **Solution:** Implement comprehensive error handling

5. **No Scan Queue Management:** Simple sequential execution
   - **Solution:** Implement proper task queue (Bull/Celery)

---

## ğŸ”œ Next Steps (Phase 2 & 3)

### Phase 2: Report Aggregation & Attack Path
- Aggregate results from all tools
- Normalize CVE data
- Correlate with NVD, ExploitDB, Rapid7
- Generate attack path visualization
- CVSS scoring
- Vulnerability prioritization

### Phase 3: RAG-Based Chatbot
- Integrate LLM (GPT-4/Claude/Llama)
- RAG implementation with vector DB
- Natural language queries
- Exploit step generation
- Remediation guidance
- CVE database integration

---

## ğŸ§ª Testing

### Manual Testing
1. Start the application
2. Create a new scan with test target
3. Verify tools execute correctly
4. Check progress updates
5. View results
6. Export data

### Test Targets
- `scanme.nmap.org` - Safe test target
- `httpbin.org` - HTTP testing
- `example.com` - Basic domain test

---

## ğŸ“ Development Notes

### Adding New Tools
1. Add tool to `TOOLS` object in `app/scan/new/page.tsx`
2. Add tool command mapping in `app/api/scan/route.ts`
3. Ensure tool is available in Docker image

### Customizing UI
- Colors: Edit `tailwind.config.ts`
- Layout: Modify component files
- Styling: Update Tailwind classes

---

## ğŸ¤ Contributing

This is a SIH 2025 project. For Phase 1:
- âœ… Core functionality complete
- âœ… All required features implemented
- âœ… Ready for Phase 2 development

---

## ğŸ“„ License

SIH 2025 Project - NTRO

---

## ğŸ‰ Status

**Phase 1: âœ… COMPLETE**

All required features for Phase 1 are implemented and functional:
- âœ… Responsive web GUI
- âœ… Active/Passive enumeration
- âœ… 12 security tools integrated
- âœ… Tool categorization
- âœ… Scan configuration
- âœ… Real-time progress
- âœ… Results display
- âœ… Export functionality

**Ready for Phase 2 development!** ğŸš€
