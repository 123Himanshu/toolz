# ğŸ›¡ï¸ Advanced Vulnerability Scanner - Complete Documentation

[![Tests](https://img.shields.io/badge/Tests-31%2F31%20Passed-brightgreen.svg)](#testing)
[![Pass Rate](https://img.shields.io/badge/Pass%20Rate-100%25-brightgreen.svg)](#testing)

A comprehensive, AI-powered vulnerability scanner with advanced threat intelligence, automated analysis, and intelligent reporting capabilities.

## ğŸ“‹ Table of Contents

1. [Overview](#overview)
2. [Features](#features)
3. [Architecture](#architecture)
4. [Installation](#installation)
5. [Usage](#usage)
6. [API Reference](#api-reference)
7. [Configuration](#configuration)
8. [Testing](#testing)
9. [Troubleshooting](#troubleshooting)
10. [Security Considerations](#security-considerations)
11. [Performance](#performance)
12. [Deployment](#deployment)
13. [Contributing](#contributing)
14. [License](#license)

---

## ğŸ¯ Overview

The Advanced Vulnerability Scanner is a next-generation security assessment platform that combines multiple industry-standard scanning tools with AI-powered analysis and intelligent reporting.

### What This Project Does

- **Multi-Tool Scanning**: Integrates 10+ security tools (Nmap, Nuclei, RustScan, etc.)
- **AI-Powered Analysis**: RAG-based chatbot for intelligent vulnerability analysis
- **Threat Intelligence**: Real-time enrichment with NVD, EPSS, CISA KEV data
- **Advanced Correlation**: Cross-scanner vulnerability correlation and deduplication
- **Compliance Reporting**: OWASP Top 10, PCI DSS compliance checking
- **Multiple Export Formats**: JSON, CSV, SARIF, HTML reports

### Three-Phase Architecture

| Phase | Purpose | Components |
|-------|---------|------------|
| **Phase 1** | Scanning | Nmap, Naabu, Nuclei, Httpx, RustScan, Trivy, etc. |
| **Phase 2** | Processing | Normalization, Enrichment, Correlation, Risk Scoring |
| **Phase 3** | Reporting | RAG Chatbot, Compliance, Exports, Analytics |

---

## âœ¨ Features

### Phase 1: Comprehensive Scanning

| Tool | Category | Purpose | Status |
|------|----------|---------|--------|
| **Nmap** | Network | Port scanning, service detection | âœ… Working |
| **Naabu** | Network | Fast port scanning | âœ… Working |
| **RustScan** | Network | Ultra-fast port scanning | âœ… Working |
| **Masscan** | Network | Internet-scale scanning | âœ… Working |
| **Nuclei** | Web | Vulnerability scanning (5000+ templates) | âœ… Working |
| **Httpx** | Web | HTTP probing, web discovery | âœ… Working |
| **Nikto** | Web | Web server scanning | âœ… Working |
| **Wapiti** | Web | Web application scanning | âœ… Working |
| **Subfinder** | Recon | Subdomain enumeration | âœ… Working |
| **Trivy** | System | Container vulnerability scanning | âœ… Working |

### Phase 2: Intelligent Processing

| Feature | Description | Status |
|---------|-------------|--------|
| **Vulnerability Normalization** | Standardized vulnerability format | âœ… Working |
| **Host Discovery** | Track discovered hosts with metadata | âœ… Working |
| **Service Discovery** | Track services running on hosts | âœ… Working |
| **Threat Intelligence** | NVD, EPSS, CISA KEV enrichment | âœ… Working |
| **MITRE ATT&CK Mapping** | Tactics and techniques correlation | âœ… Working |
| **Risk Scoring** | Automated CVSS and custom risk assessment | âœ… Working |
| **Attack Path Generation** | Potential attack vector analysis | âœ… Working |
| **Cross-Scanner Correlation** | Duplicate detection and merging | âœ… Working |
| **Zero-Day Exposure Score** | Custom scoring for unknown vulnerabilities | âœ… Working |

### Phase 3: AI-Powered Analysis & Reporting

| Feature | Description | Status |
|---------|-------------|--------|
| **RAG Chatbot** | Context-aware vulnerability analysis | âœ… Working |
| **OWASP Top 10 Compliance** | Compliance checking | âœ… Working |
| **PCI DSS Compliance** | Compliance checking | âœ… Working |
| **JSON Export** | Machine-readable format | âœ… Working |
| **CSV Export** | Spreadsheet format | âœ… Working |
| **SARIF Export** | CI/CD integration format | âœ… Working |
| **HTML Export** | Human-readable reports | âœ… Working |
| **Trending Analysis** | Historical vulnerability trends | âœ… Working |
| **Remediation Planning** | Prioritized fix recommendations | âœ… Working |

---

## ğŸ—ï¸ Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   PHASE 1       â”‚    â”‚   PHASE 2       â”‚    â”‚   PHASE 3       â”‚
â”‚   Scanning      â”‚â”€â”€â”€â–¶â”‚   Processing    â”‚â”€â”€â”€â–¶â”‚   AI & Reports  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ Nmap          â”‚    â”‚ â€¢ Normalization â”‚    â”‚ â€¢ RAG Chatbot   â”‚
â”‚ â€¢ Nuclei        â”‚    â”‚ â€¢ Enrichment    â”‚    â”‚ â€¢ Compliance    â”‚
â”‚ â€¢ RustScan      â”‚    â”‚ â€¢ Correlation   â”‚    â”‚ â€¢ Export        â”‚
â”‚ â€¢ Httpx         â”‚    â”‚ â€¢ Risk Scoring  â”‚    â”‚ â€¢ Analytics     â”‚
â”‚ â€¢ Subfinder     â”‚    â”‚ â€¢ Attack Paths  â”‚    â”‚ â€¢ Trending      â”‚
â”‚ â€¢ Trivy         â”‚    â”‚ â€¢ Remediation   â”‚    â”‚ â€¢ Classificationâ”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                       â”‚                       â”‚
         â–¼                       â–¼                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   PostgreSQL    â”‚    â”‚    MongoDB      â”‚    â”‚    Qdrant       â”‚
â”‚ (Structured)    â”‚    â”‚ (Raw Results)   â”‚    â”‚ (Vector Search) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Technology Stack

| Layer | Technology |
|-------|------------|
| **Frontend** | Next.js 15, React, TypeScript, Tailwind CSS |
| **Backend** | Node.js, Next.js API Routes |
| **Databases** | PostgreSQL, MongoDB, Redis, Qdrant |
| **Security Tools** | Docker-containerized scanners |
| **AI/ML** | OpenAI GPT, Groq, Gemini |
| **Infrastructure** | Docker, Docker Compose |

---

## ğŸ“¦ Installation

### Prerequisites

- Node.js 18+
- Docker & Docker Compose
- Git
- 8GB+ RAM (recommended)
- 20GB+ disk space

### Quick Start

```bash
# Clone repository
git clone <repository-url>
cd vulnerability-scanner

# Install dependencies
npm install

# Start database services
docker-compose up -d

# Build security scanner image
cd ../security-scanner
docker build -t security-scanner .
cd ../vulnerability-scanner

# Start application
npm run dev

# Open browser
# http://localhost:3000
```

### Verify Installation

```bash
npx tsx scripts/comprehensive-test.ts
```

Expected output: `Pass Rate: 100.0%`

---

## ğŸ® Usage

### Web Interface

1. Open http://localhost:3000
2. Enter target (IP, domain, or URL)
3. Select scanning tools
4. Start scan and monitor progress
5. Use AI chatbot for analysis
6. Export reports

### API Usage

```javascript
// Start a scan
const response = await fetch('/api/scan', {
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify({
    target: 'scanme.nmap.org',
    scanType: 'active',
    tools: {
      network: ['nmap', 'naabu'],
      web: ['nuclei', 'httpx'],
      system: []
    }
  })
});

const { scanId } = await response.json();

// Check scan status
const status = await fetch(`/api/scan?scanId=${scanId}`);

// Query AI chatbot
const analysis = await fetch('/api/chat', {
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify({
    message: 'What vulnerabilities were found?',
    scanId
  })
});
```

---

## ğŸ“š API Reference

### Scan API

| Endpoint | Method | Description |
|----------|--------|-------------|
| `/api/scan` | GET | List all scans |
| `/api/scan` | POST | Create new scan |
| `/api/scan?scanId=xxx` | GET | Get scan details |

### Phase 2 APIs

| Endpoint | Method | Description |
|----------|--------|-------------|
| `/api/phase2/vulnerabilities` | GET | Get normalized vulnerabilities |
| `/api/phase2/hosts` | GET | Get discovered hosts |
| `/api/phase2/services` | GET | Get discovered services |
| `/api/phase2/threat-intel` | GET/POST | Threat intelligence enrichment |
| `/api/phase2/mitre` | GET | MITRE ATT&CK mapping |
| `/api/phase2/zdes` | GET | Zero-Day Exposure Score |
| `/api/phase2/attack-paths` | GET | Attack path generation |
| `/api/phase2/correlation` | GET | Cross-scanner correlation |
| `/api/phase2/statistics` | GET | Scan statistics |
| `/api/phase2/remediation` | GET | Remediation planning |
| `/api/phase2/trending` | GET | Trending analysis |
| `/api/phase2/compliance` | GET | Compliance checking |
| `/api/phase2/export` | GET | Export reports |

### Chat API

| Endpoint | Method | Description |
|----------|--------|-------------|
| `/api/chat` | POST | AI chatbot query |

### Utility APIs

| Endpoint | Method | Description |
|----------|--------|-------------|
| `/api/classify-targets` | POST | Target classification |

---

## âš™ï¸ Configuration

### Environment Variables

```bash
# Database Configuration
POSTGRES_URL="postgresql://scanner:scanner123@localhost:5432/vulnerability_scanner"
MONGODB_URL="mongodb://scanner:scanner123@localhost:27017/vulnerability_scanner"
REDIS_URL="redis://localhost:6379"
QDRANT_URL="http://localhost:6333"

# AI Configuration
OPENAI_API_KEY="your-openai-key"
GROQ_API_KEY="your-groq-key"
GEMINI_API_KEY="your-gemini-key"

# System Configuration
MAX_CONCURRENT_SCANS=3
SCAN_TIMEOUT_MINUTES=30
```

---

## ğŸ§ª Testing

### Run All Tests

```bash
npx tsx scripts/comprehensive-test.ts
```

### Test Results (31/31 Passed - 100%)

| Category | Tests | Status |
|----------|-------|--------|
| Phase 1: Scanning Tools | 6/6 | âœ… 100% |
| Phase 2: Processing | 16/16 | âœ… 100% |
| Phase 3: Reporting | 9/9 | âœ… 100% |

---

## ğŸ”§ Troubleshooting

### Common Issues

| Issue | Solution |
|-------|----------|
| Docker not running | Start Docker Desktop |
| Port 3000 in use | Change port in `.env.local` |
| Scan timeout | Increase `SCAN_TIMEOUT_MINUTES` |
| AI rate limit | Switch to different AI provider |
| Database connection | Check Docker containers are running |

### Debug Commands

```bash
# Check server health
curl http://localhost:3000/api/scan

# Check Docker containers
docker ps

# View server logs
npm run dev
```

---

## ğŸ”’ Security Considerations

- **Never scan targets without permission**
- Use `scanme.nmap.org` for testing (legal target)
- Store API keys securely
- Enable authentication in production
- Use HTTPS in production
- Implement rate limiting

---

## ğŸ“ˆ Performance

| Metric | Value |
|--------|-------|
| Typical scan time | 60-90 seconds |
| Concurrent scans | 3 (configurable) |
| Memory usage | ~500MB |
| Disk usage | ~2GB (with Docker images) |

---

## ğŸš€ Deployment

### Production Checklist

- [ ] Set `NODE_ENV=production`
- [ ] Enable authentication
- [ ] Configure HTTPS
- [ ] Set up monitoring
- [ ] Configure backups
- [ ] Set rate limits

### Docker Deployment

```bash
docker-compose -f docker-compose.prod.yml up -d
```

---

## ğŸ¤ Contributing

1. Fork the repository
2. Create feature branch
3. Make changes
4. Run tests
5. Submit pull request

---

## ğŸ“„ License

MIT License - See LICENSE file for details.

---

## ğŸ“ Support

- GitHub Issues for bug reports
- Discussions for questions
- Pull requests for contributions
