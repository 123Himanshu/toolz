/**
 * Tool Capabilities and Smart Selection
 * Defines each tool's role, capabilities, and when to use it
 */

export interface ToolCapability {
  id: string;
  name: string;
  description: string;
  role: 'core' | 'speed' | 'scale' | 'specialized';
  category: 'network' | 'web' | 'system';
  capabilities: string[];
  strengths: string[];
  limitations: string[];
  useWhen: string[];
  avoidWhen: string[];
  integrationLevel: number; // 0-100%
  recommended: boolean;
  icon: string;
}

export const TOOL_CAPABILITIES: Record<string, ToolCapability> = {
  // ==================== NETWORK TOOLS ====================
  
  nmap: {
    id: 'nmap',
    name: 'Nmap',
    description: 'Core network scanner - industry standard for service detection',
    role: 'core',
    category: 'network',
    capabilities: [
      'Port scanning (TCP/UDP)',
      'Service version detection',
      'OS fingerprinting',
      'NSE scripts (600+)',
      'Firewall detection',
      'Traceroute'
    ],
    strengths: [
      'Most comprehensive network scanner',
      'Accurate service detection',
      'Extensive script library',
      'Industry standard'
    ],
    limitations: [
      'Slower than specialized scanners',
      'Can be noisy (detected by IDS)'
    ],
    useWhen: [
      'Need detailed service information',
      'Require OS fingerprinting',
      'Want to run NSE scripts',
      'Standard network reconnaissance'
    ],
    avoidWhen: [
      'Scanning very large IP ranges (use Masscan)',
      'Need ultra-fast port discovery (use RustScan first)'
    ],
    integrationLevel: 100,
    recommended: true,
    icon: 'Network'
  },

  rustscan: {
    id: 'rustscan',
    name: 'RustScan',
    description: 'Ultra-fast port scanner - feeds results to Nmap',
    role: 'speed',
    category: 'network',
    capabilities: [
      'Ultra-fast port scanning (3 sec for 65535 ports)',
      'Adaptive timing',
      'Nmap integration',
      'Batch scanning'
    ],
    strengths: [
      'Fastest port scanner available',
      'Automatically feeds to Nmap',
      'Modern Rust architecture',
      'Low resource usage'
    ],
    limitations: [
      'Only port discovery (no service detection)',
      'Requires Nmap for detailed analysis'
    ],
    useWhen: [
      'Need fast port discovery',
      'Scanning single targets',
      'Want to speed up Nmap',
      'Time-sensitive scans'
    ],
    avoidWhen: [
      'Scanning large IP ranges (use Masscan)',
      'Need service detection only (use Nmap directly)'
    ],
    integrationLevel: 30,
    recommended: true,
    icon: 'Zap'
  },

  masscan: {
    id: 'masscan',
    name: 'Masscan',
    description: 'Internet-scale scanner - optimized for large IP ranges',
    role: 'scale',
    category: 'network',
    capabilities: [
      'Internet-scale scanning (10M packets/sec)',
      'Asynchronous transmission',
      'TCP SYN scanning',
      'Banner grabbing'
    ],
    strengths: [
      'Fastest for large ranges',
      'Can scan entire internet',
      'Stateless scanning',
      'Highly scalable'
    ],
    limitations: [
      'Less accurate than Nmap',
      'No service version detection',
      'Requires careful rate limiting'
    ],
    useWhen: [
      'Scanning /16 or /24 networks',
      'Need to scan 1000+ IPs',
      'Internet-wide research',
      'Bug bounty reconnaissance'
    ],
    avoidWhen: [
      'Scanning single targets (use RustScan)',
      'Need service detection (use Nmap)',
      'Require accuracy over speed'
    ],
    integrationLevel: 40,
    recommended: false,
    icon: 'Globe'
  },

  naabu: {
    id: 'naabu',
    name: 'Naabu',
    description: 'Fast port scanner with clean JSON output',
    role: 'speed',
    category: 'network',
    capabilities: [
      'Fast SYN/CONNECT scanning',
      'Clean JSON output',
      'Host discovery',
      'CDN detection'
    ],
    strengths: [
      'API-friendly JSON output',
      'Good for automation',
      'Reliable and fast',
      'Low false positives'
    ],
    limitations: [
      'No service detection',
      'Limited to port discovery'
    ],
    useWhen: [
      'Need clean JSON output',
      'Building automation',
      'API integration',
      'Subdomain port scanning'
    ],
    avoidWhen: [
      'Need service versions (use Nmap)',
      'Scanning large ranges (use Masscan)'
    ],
    integrationLevel: 30,
    recommended: true,
    icon: 'Target'
  },

  // ==================== WEB TOOLS ====================

  nuclei: {
    id: 'nuclei',
    name: 'Nuclei',
    description: 'Core CVE scanner - 5000+ vulnerability templates',
    role: 'core',
    category: 'web',
    capabilities: [
      '5000+ vulnerability templates',
      'CVE detection',
      'Fuzzing',
      'Custom workflows',
      'Template engine',
      'Headless browser support'
    ],
    strengths: [
      'Largest template library',
      'Fast and efficient',
      'Community-driven',
      'Highly customizable',
      'Regular updates'
    ],
    limitations: [
      'Template-based (may miss custom vulns)',
      'Requires template updates'
    ],
    useWhen: [
      'CVE scanning',
      'Known vulnerability detection',
      'Web application testing',
      'Bug bounty hunting'
    ],
    avoidWhen: [
      'Custom application logic testing',
      'Complex authentication flows'
    ],
    integrationLevel: 100,
    recommended: true,
    icon: 'Zap'
  },

  wapiti: {
    id: 'wapiti',
    name: 'Wapiti',
    description: 'Fast web vulnerability scanner - quick checks',
    role: 'speed',
    category: 'web',
    capabilities: [
      'Black-box testing',
      'XSS detection',
      'SQL injection',
      'File inclusion',
      'Command injection',
      'CRLF injection'
    ],
    strengths: [
      'Fast scanning',
      'Good for quick checks',
      'Multiple vulnerability types',
      'Easy to use'
    ],
    limitations: [
      'May have false positives',
      'Limited customization',
      'Basic reporting'
    ],
    useWhen: [
      'Quick vulnerability checks',
      'Time-constrained scans',
      'Initial reconnaissance',
      'Quick web vulnerability checks'
    ],
    avoidWhen: [
      'Need comprehensive DAST',
      'Complex applications'
    ],
    integrationLevel: 50,
    recommended: true,
    icon: 'Activity'
  },

  nikto: {
    id: 'nikto',
    name: 'Nikto',
    description: 'Legacy web server scanner - 6800+ checks',
    role: 'specialized',
    category: 'web',
    capabilities: [
      '6800+ server checks',
      'Outdated software detection',
      'Misconfiguration detection',
      'Default files',
      'Dangerous files'
    ],
    strengths: [
      'Excellent for old servers',
      'Apache/IIS/Nginx checks',
      'Misconfiguration detection',
      'Large signature database'
    ],
    limitations: [
      'Slow scanning',
      'Many false positives',
      'Outdated for modern apps',
      'Noisy (easily detected)'
    ],
    useWhen: [
      'Scanning legacy servers',
      'Apache 2.2 or older',
      'IIS 6 or older',
      'Misconfiguration checks'
    ],
    avoidWhen: [
      'Modern web applications',
      'Cloud-native apps',
      'Need stealth'
    ],
    integrationLevel: 30,
    recommended: false,
    icon: 'Server'
  },

  // ==================== SYSTEM TOOLS ====================

  trivy: {
    id: 'trivy',
    name: 'Trivy',
    description: 'Core container/IaC scanner - comprehensive vulnerability detection',
    role: 'core',
    category: 'system',
    capabilities: [
      'Container image scanning',
      'Filesystem scanning',
      'IaC scanning (Terraform, K8s)',
      'SBOM generation',
      'License detection',
      'Secret detection',
      'Compliance checks'
    ],
    strengths: [
      'Most comprehensive container scanner',
      'Fast and accurate',
      'Multiple scan types',
      'SBOM support',
      'Regular updates'
    ],
    limitations: [
      'Focused on containers/IaC',
      'Not for network vulnerabilities'
    ],
    useWhen: [
      'Container security',
      'IaC scanning',
      'Dependency scanning',
      'SBOM generation',
      'DevSecOps pipelines'
    ],
    avoidWhen: [
      'Network vulnerability scanning (use OpenVAS)',
      'Web application testing'
    ],
    integrationLevel: 100,
    recommended: true,
    icon: 'Package'
  },

  openvas: {
    id: 'openvas',
    name: 'OpenVAS',
    description: 'Core enterprise CVE scanner - 50,000+ tests',
    role: 'core',
    category: 'system',
    capabilities: [
      '50,000+ vulnerability tests',
      'Network vulnerability scanning',
      'Authenticated scanning',
      'Compliance checks',
      'Patch management',
      'Asset management'
    ],
    strengths: [
      'Most comprehensive CVE scanner',
      'Enterprise-grade',
      'Authenticated scans',
      'Compliance reporting',
      'Regular NVT updates'
    ],
    limitations: [
      'Slow scanning',
      'Resource intensive',
      'Complex setup',
      'Can be overwhelming'
    ],
    useWhen: [
      'Comprehensive vulnerability assessment',
      'Compliance requirements',
      'Enterprise environments',
      'Authenticated scanning'
    ],
    avoidWhen: [
      'Quick scans (use Trivy)',
      'Container-only scanning',
      'Limited resources'
    ],
    integrationLevel: 100,
    recommended: true,
    icon: 'Shield'
  },

  nessus: {
    id: 'nessus',
    name: 'Nessus Professional',
    description: 'Industry-leading vulnerability scanner - 65,000+ plugins',
    role: 'core',
    category: 'system',
    capabilities: [
      '65,000+ vulnerability plugins',
      'Advanced network scanning',
      'Authenticated credentialed scans',
      'Compliance auditing (PCI, HIPAA, CIS)',
      'Web application scanning',
      'Malware detection',
      'Configuration auditing',
      'Live results dashboard'
    ],
    strengths: [
      'Industry standard for enterprises',
      'Most comprehensive plugin library',
      'Advanced reporting and dashboards',
      'Excellent accuracy (low false positives)',
      'Regular plugin updates',
      'Professional support'
    ],
    limitations: [
      'Commercial license required',
      'Resource intensive',
      'Slower than lightweight scanners',
      'Requires expertise to configure'
    ],
    useWhen: [
      'Enterprise vulnerability management',
      'Compliance requirements (PCI-DSS, HIPAA)',
      'Comprehensive security audits',
      'Professional penetration testing',
      'Critical infrastructure scanning'
    ],
    avoidWhen: [
      'Quick scans needed',
      'Budget constraints',
      'Container-only scanning (use Trivy)'
    ],
    integrationLevel: 100,
    recommended: true,
    icon: 'ShieldCheck'
  }
};

/**
 * Get tool recommendations based on target type
 */
export function getToolRecommendations(targetType: string): string[] {
  const recommendations: string[] = [];

  switch (targetType.toLowerCase()) {
    case 'web application':
    case 'url':
      recommendations.push('rustscan', 'nmap', 'nuclei', 'wapiti', 'trivy', 'nessus');
      break;
    
    case 'ip range':
    case 'cidr':
      recommendations.push('masscan', 'nmap', 'trivy', 'nessus');
      break;
    
    case 'ip address':
      recommendations.push('rustscan', 'nmap', 'nuclei', 'trivy', 'nessus');
      break;
    
    case 'domain':
      recommendations.push('rustscan', 'nmap', 'nuclei', 'wapiti', 'trivy', 'nessus');
      break;
    
    default:
      recommendations.push('nmap', 'nuclei', 'trivy', 'nessus');
  }

  return recommendations;
}

/**
 * Get tool by category
 */
export function getToolsByCategory(category: 'network' | 'web' | 'system'): ToolCapability[] {
  return Object.values(TOOL_CAPABILITIES).filter(tool => tool.category === category);
}

/**
 * Get core tools (100% integration)
 */
export function getCoreTools(): ToolCapability[] {
  return Object.values(TOOL_CAPABILITIES).filter(tool => tool.role === 'core');
}

/**
 * Get tool by ID
 */
export function getToolById(id: string): ToolCapability | undefined {
  return TOOL_CAPABILITIES[id];
}
