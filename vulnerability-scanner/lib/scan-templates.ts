/**
 * Scan Templates
 * Pre-configured scan profiles for common use cases
 */

export interface ScanTemplate {
  id: string;
  name: string;
  description: string;
  icon: string;
  scanType: 'passive' | 'active' | 'both';
  tools: {
    network: string[];
    web: string[];
    system: string[];
  };
  config: {
    intensity: 'light' | 'normal' | 'aggressive';
    rate: number;
    depth: number;
    timeout: number;
  };
  estimatedDuration: string;
  useCase: string;
  recommended: boolean;
}

export const SCAN_TEMPLATES: ScanTemplate[] = [
  {
    id: 'quick-scan',
    name: 'Quick Scan',
    description: 'Fast reconnaissance with essential tools',
    icon: 'âš¡',
    scanType: 'active',
    tools: {
      network: ['nmap'],
      web: ['nuclei'],
      system: []
    },
    config: {
      intensity: 'light',
      rate: 1000,
      depth: 2,
      timeout: 180
    },
    estimatedDuration: '2-5 minutes',
    useCase: 'Quick vulnerability check',
    recommended: true
  },
  {
    id: 'full-scan',
    name: 'Full Scan',
    description: 'Comprehensive security assessment',
    icon: 'ðŸ”',
    scanType: 'both',
    tools: {
      network: ['nmap', 'naabu', 'masscan'],
      web: ['nuclei', 'wapiti'],
      system: ['trivy']
    },
    config: {
      intensity: 'aggressive',
      rate: 1500,
      depth: 5,
      timeout: 600
    },
    estimatedDuration: '15-30 minutes',
    useCase: 'Complete security audit',
    recommended: false
  },
  {
    id: 'web-only',
    name: 'Web Application',
    description: 'Focus on web vulnerabilities',
    icon: 'ðŸŒ',
    scanType: 'active',
    tools: {
      network: [],
      web: ['nuclei', 'wapiti', 'nikto'],
      system: []
    },
    config: {
      intensity: 'normal',
      rate: 1000,
      depth: 4,
      timeout: 400
    },
    estimatedDuration: '8-15 minutes',
    useCase: 'Web application testing',
    recommended: true
  },
  {
    id: 'network-only',
    name: 'Network Scan',
    description: 'Network infrastructure assessment',
    icon: 'ðŸ”Œ',
    scanType: 'active',
    tools: {
      network: ['nmap', 'naabu', 'rustscan'],
      web: [],
      system: []
    },
    config: {
      intensity: 'normal',
      rate: 2000,
      depth: 3,
      timeout: 300
    },
    estimatedDuration: '5-10 minutes',
    useCase: 'Network reconnaissance',
    recommended: true
  },
  {
    id: 'passive-recon',
    name: 'Passive Reconnaissance',
    description: 'Non-intrusive information gathering',
    icon: 'ðŸ‘ï¸',
    scanType: 'passive',
    tools: {
      network: [],
      web: [],
      system: []
    },
    config: {
      intensity: 'light',
      rate: 500,
      depth: 2,
      timeout: 120
    },
    estimatedDuration: '1-3 minutes',
    useCase: 'Stealth reconnaissance',
    recommended: false
  },
  {
    id: 'container-scan',
    name: 'Container Security',
    description: 'Docker and container vulnerability scan',
    icon: 'ðŸ“¦',
    scanType: 'active',
    tools: {
      network: [],
      web: [],
      system: ['trivy', 'openvas']
    },
    config: {
      intensity: 'normal',
      rate: 1000,
      depth: 3,
      timeout: 300
    },
    estimatedDuration: '5-8 minutes',
    useCase: 'Container security audit',
    recommended: false
  },
  {
    id: 'api-scan',
    name: 'API Security',
    description: 'REST API vulnerability assessment',
    icon: 'ðŸ”—',
    scanType: 'active',
    tools: {
      network: ['nmap'],
      web: ['nuclei', 'wapiti'],
      system: []
    },
    config: {
      intensity: 'normal',
      rate: 1000,
      depth: 4,
      timeout: 350
    },
    estimatedDuration: '6-12 minutes',
    useCase: 'API endpoint testing',
    recommended: true
  },
  {
    id: 'wordpress-scan',
    name: 'WordPress Security',
    description: 'WordPress-specific vulnerability scan',
    icon: 'ðŸ“',
    scanType: 'active',
    tools: {
      network: ['nmap'],
      web: ['nuclei', 'wapiti'],
      system: []
    },
    config: {
      intensity: 'normal',
      rate: 1000,
      depth: 4,
      timeout: 400
    },
    estimatedDuration: '8-15 minutes',
    useCase: 'WordPress site audit',
    recommended: false
  }
];

/**
 * Get template by ID
 */
export function getTemplateById(id: string): ScanTemplate | undefined {
  return SCAN_TEMPLATES.find(template => template.id === id);
}

/**
 * Get recommended templates
 */
export function getRecommendedTemplates(): ScanTemplate[] {
  return SCAN_TEMPLATES.filter(template => template.recommended);
}

/**
 * Get template by use case
 */
export function getTemplatesByUseCase(useCase: string): ScanTemplate[] {
  return SCAN_TEMPLATES.filter(template => 
    template.useCase.toLowerCase().includes(useCase.toLowerCase())
  );
}

/**
 * Suggest template based on target
 */
export function suggestTemplate(target: string): ScanTemplate {
  const trimmedTarget = target.trim().toLowerCase();
  
  // Web application
  if (trimmedTarget.startsWith('http://') || trimmedTarget.startsWith('https://')) {
    if (trimmedTarget.includes('api')) {
      return getTemplateById('api-scan')!;
    }
    if (trimmedTarget.includes('wordpress') || trimmedTarget.includes('wp-')) {
      return getTemplateById('wordpress-scan')!;
    }
    return getTemplateById('web-only')!;
  }
  
  // IP address or domain
  if (/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/.test(trimmedTarget)) {
    return getTemplateById('network-only')!;
  }
  
  // Default to quick scan
  return getTemplateById('quick-scan')!;
}
