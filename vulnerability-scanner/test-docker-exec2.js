const { exec } = require('child_process');

console.log('Testing actual nmap scan from Node.js...\n');

const command = 'docker run --rm -i security-scanner python3 -c "from nmap_wrapper import NmapWrapper; import json; scanner = NmapWrapper(docker_mode=False); result = scanner.quick_scan(\'scanme.nmap.org\'); print(json.dumps(result, default=str))"';

console.log('Command:', command);
console.log('\nExecuting...\n');

exec(command, { timeout: 120000, maxBuffer: 1024 * 1024 * 10 }, (err, stdout, stderr) => {
  console.log('=== STDOUT ===');
  console.log(stdout.substring(0, 500));
  console.log('\n=== STDERR ===');
  console.log(stderr);
  if (err) {
    console.log('\n=== ERROR ===');
    console.log(err.message);
  }
  console.log('\nDone!');
});
