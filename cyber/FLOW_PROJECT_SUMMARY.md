# Attack Path Intelligence Engine - Complete Flow Summary

## ðŸŽ¯ Project Overview

**Purpose:** Automated cybersecurity system that transforms raw vulnerability scan data into actionable attack path intelligence with zero-day exposure detection.

**Scale:** Production-grade system with 54 files, 8,500+ lines of code, supporting 10+ vulnerability scanners.

---

## ðŸ“Š System Architecture Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    USER INPUT (Scan Files)                      â”‚
â”‚  Nmap XML â”‚ Nuclei JSON â”‚ Nessus XML â”‚ Trivy JSON â”‚ etc.       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  LAYER 1: INGESTION (10 Parsers)                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚   Nmap   â”‚ â”‚  Nuclei  â”‚ â”‚  Nessus  â”‚ â”‚  Trivy   â”‚ ...      â”‚
â”‚  â”‚  Parser  â”‚ â”‚  Parser  â”‚ â”‚  Parser  â”‚ â”‚  Parser  â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜          â”‚
â”‚       â”‚            â”‚            â”‚            â”‚                  â”‚
â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
â”‚                         â”‚                                        â”‚
â”‚              Raw Vulnerability Objects                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              LAYER 2: NORMALIZATION PIPELINE                    â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Step 1: Group by Asset + Port + CVE                     â”‚  â”‚
â”‚  â”‚ Step 2: Deduplicate identical findings                  â”‚  â”‚
â”‚  â”‚ Step 3: Merge data from multiple scanners               â”‚  â”‚
â”‚  â”‚ Step 4: Resolve conflicts (highest CVSS, most severe)   â”‚  â”‚
â”‚  â”‚ Step 5: CVE-based final deduplication                   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                         â”‚                                       â”‚
â”‚              Normalized Vulnerability List                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           LAYER 3: THREAT INTELLIGENCE ENRICHMENT               â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚   NVD    â”‚  â”‚   EPSS   â”‚  â”‚ExploitDB â”‚  â”‚  MITRE   â”‚      â”‚
â”‚  â”‚   API    â”‚  â”‚   API    â”‚  â”‚  Search  â”‚  â”‚  ATT&CK  â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜      â”‚
â”‚       â”‚             â”‚             â”‚             â”‚              â”‚
â”‚       â”œâ”€ CVE Detailsâ”‚             â”‚             â”‚              â”‚
â”‚       â”œâ”€ CVSS Scoresâ”œâ”€ Exploit    â”œâ”€ Public     â”œâ”€ Technique  â”‚
â”‚       â”œâ”€ References â”‚  Probabilityâ”‚  Exploits   â”‚  Mapping    â”‚
â”‚       â””â”€ Patches    â””â”€ Percentile â””â”€ Metadata   â””â”€ Tactics    â”‚
â”‚                         â”‚                                       â”‚
â”‚              Enriched Vulnerability Data                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              LAYER 4: ATTACK GRAPH CONSTRUCTION                 â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Graph Nodes:                                            â”‚  â”‚
â”‚  â”‚  â€¢ Assets (systems)                                     â”‚  â”‚
â”‚  â”‚  â€¢ Privilege Levels (USER â†’ ADMIN â†’ SYSTEM)            â”‚  â”‚
â”‚  â”‚  â€¢ Entry Points (ATTACKER, external assets)            â”‚  â”‚
â”‚  â”‚                                                         â”‚  â”‚
â”‚  â”‚ Graph Edges:                                            â”‚  â”‚
â”‚  â”‚  â€¢ Vulnerabilities (exploit paths)                     â”‚  â”‚
â”‚  â”‚  â€¢ Network Reachability (connectivity)                 â”‚  â”‚
â”‚  â”‚  â€¢ Privilege Escalation (within asset)                 â”‚  â”‚
â”‚  â”‚  â€¢ Lateral Movement (between assets)                   â”‚  â”‚
â”‚  â”‚  â€¢ Credential Reuse                                     â”‚  â”‚
â”‚  â”‚  â€¢ Trust Relationships                                  â”‚  â”‚
â”‚  â”‚                                                         â”‚  â”‚
â”‚  â”‚ Edge Weighting:                                         â”‚  â”‚
â”‚  â”‚  weight = base - (cvss/10)*3 - epss*2                  â”‚  â”‚
â”‚  â”‚          - (exploit_available ? 2 : 0)                 â”‚  â”‚
â”‚  â”‚          + privilege_required_factor                    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                         â”‚                                       â”‚
â”‚              NetworkX Directed Graph                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              LAYER 5: ATTACK PATH GENERATION                    â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Path Types Generated:                                   â”‚  â”‚
â”‚  â”‚                                                         â”‚  â”‚
â”‚  â”‚ 1. Simple Paths                                         â”‚  â”‚
â”‚  â”‚    Entry â†’ Target (single exploit)                     â”‚  â”‚
â”‚  â”‚                                                         â”‚  â”‚
â”‚  â”‚ 2. Chained Paths                                        â”‚  â”‚
â”‚  â”‚    Entry â†’ Asset1 â†’ Asset2 â†’ Target                    â”‚  â”‚
â”‚  â”‚                                                         â”‚  â”‚
â”‚  â”‚ 3. Shortest Paths (Dijkstra)                           â”‚  â”‚
â”‚  â”‚    Minimum steps to compromise                          â”‚  â”‚
â”‚  â”‚                                                         â”‚  â”‚
â”‚  â”‚ 4. Highest Impact Paths                                 â”‚  â”‚
â”‚  â”‚    Maximum damage potential                             â”‚  â”‚
â”‚  â”‚                                                         â”‚  â”‚
â”‚  â”‚ 5. Most Probable Paths (EPSS-based)                    â”‚  â”‚
â”‚  â”‚    Highest likelihood of exploitation                   â”‚  â”‚
â”‚  â”‚                                                         â”‚  â”‚
â”‚  â”‚ Each Path Contains:                                     â”‚  â”‚
â”‚  â”‚  â€¢ Source and target assets                            â”‚  â”‚
â”‚  â”‚  â€¢ Exploit used at each step                           â”‚  â”‚
â”‚  â”‚  â€¢ Privilege gained                                     â”‚  â”‚
â”‚  â”‚  â€¢ MITRE ATT&CK technique                              â”‚  â”‚
â”‚  â”‚  â€¢ Impact and complexity scores                         â”‚  â”‚
â”‚  â”‚  â€¢ Exploitability score                                 â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                         â”‚                                       â”‚
â”‚              Attack Path Objects                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         LAYER 6: ZERO-DAY DETECTION (3-Layer Approach)          â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ LAYER 6A: ZDES (Zero-Day Exposure Score)               â”‚  â”‚
â”‚  â”‚                                                         â”‚  â”‚
â”‚  â”‚ Scoring Factors (0-100):                               â”‚  â”‚
â”‚  â”‚  â€¢ Unknown/unclassified services      (20 points)      â”‚  â”‚
â”‚  â”‚  â€¢ End-of-Life software               (25 points)      â”‚  â”‚
â”‚  â”‚  â€¢ Unknown version fingerprints       (15 points)      â”‚  â”‚
â”‚  â”‚  â€¢ Weak configurations                (10 points)      â”‚  â”‚
â”‚  â”‚  â€¢ Abnormal port-service mappings     (10 points)      â”‚  â”‚
â”‚  â”‚  â€¢ Unpatched vulnerabilities          (10 points)      â”‚  â”‚
â”‚  â”‚  â€¢ External exposure                  (10 points)      â”‚  â”‚
â”‚  â”‚                                                         â”‚  â”‚
â”‚  â”‚ Output: ZDES score per asset (0-100)                   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                         â”‚                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ LAYER 6B: Anomaly Detection                            â”‚  â”‚
â”‚  â”‚                                                         â”‚  â”‚
â”‚  â”‚ Baseline Comparison:                                    â”‚  â”‚
â”‚  â”‚  â€¢ New ports opened since last scan                    â”‚  â”‚
â”‚  â”‚  â€¢ Service changes on existing ports                   â”‚  â”‚
â”‚  â”‚  â€¢ Scanner disagreements                               â”‚  â”‚
â”‚  â”‚  â€¢ Suspicious patterns                                  â”‚  â”‚
â”‚  â”‚  â€¢ Deviations from normal state                        â”‚  â”‚
â”‚  â”‚                                                         â”‚  â”‚
â”‚  â”‚ Output: Anomaly indicators                             â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                         â”‚                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ LAYER 6C: Exploit Behavior Detection                   â”‚  â”‚
â”‚  â”‚                                                         â”‚  â”‚
â”‚  â”‚ Behavioral Patterns:                                    â”‚  â”‚
â”‚  â”‚  â€¢ Rapid privilege escalation                          â”‚  â”‚
â”‚  â”‚  â€¢ Unexpected lateral movement                         â”‚  â”‚
â”‚  â”‚  â€¢ RCE-like vulnerability patterns                     â”‚  â”‚
â”‚  â”‚  â€¢ Suspicious internal pivot paths                     â”‚  â”‚
â”‚  â”‚  â€¢ Toxic CVE combinations                              â”‚  â”‚
â”‚  â”‚                                                         â”‚  â”‚
â”‚  â”‚ Output: Behavior-based risk events                     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                         â”‚                                       â”‚
â”‚              Zero-Day Indicator Objects                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           LAYER 7: CORRELATION & RISK MODELING                  â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Risk Score Calculation (Weighted Model):                â”‚  â”‚
â”‚  â”‚                                                         â”‚  â”‚
â”‚  â”‚ Risk = CVSS(25%) + EPSS(20%) + Exploitability(20%)    â”‚  â”‚
â”‚  â”‚      + ChainPotential(15%) + ZDES(10%) + PathImpact(10%)â”‚ â”‚
â”‚  â”‚                                                         â”‚  â”‚
â”‚  â”‚ Where:                                                  â”‚  â”‚
â”‚  â”‚  â€¢ CVSS: Base vulnerability severity                   â”‚  â”‚
â”‚  â”‚  â€¢ EPSS: Exploit prediction score                      â”‚  â”‚
â”‚  â”‚  â€¢ Exploitability: Public exploit availability         â”‚  â”‚
â”‚  â”‚  â€¢ ChainPotential: Number of attack paths              â”‚  â”‚
â”‚  â”‚  â€¢ ZDES: Zero-day exposure score                       â”‚  â”‚
â”‚  â”‚  â€¢ PathImpact: Average attack path impact              â”‚  â”‚
â”‚  â”‚                                                         â”‚  â”‚
â”‚  â”‚ Risk Levels:                                            â”‚  â”‚
â”‚  â”‚  â€¢ CRITICAL: 80-100                                     â”‚  â”‚
â”‚  â”‚  â€¢ HIGH: 60-79                                          â”‚  â”‚
â”‚  â”‚  â€¢ MEDIUM: 40-59                                        â”‚  â”‚
â”‚  â”‚  â€¢ LOW: 20-39                                           â”‚  â”‚
â”‚  â”‚  â€¢ INFO: 0-19                                           â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                         â”‚                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Correlation Outputs:                                    â”‚  â”‚
â”‚  â”‚  â€¢ Per-asset risk scores                               â”‚  â”‚
â”‚  â”‚  â€¢ High-risk asset ranking                             â”‚  â”‚
â”‚  â”‚  â€¢ Critical attack paths                               â”‚  â”‚
â”‚  â”‚  â€¢ Kill chain sequences                                 â”‚  â”‚
â”‚  â”‚  â€¢ Zero-day exposure map                               â”‚  â”‚
â”‚  â”‚  â€¢ Network-wide risk score                             â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                         â”‚                                       â”‚
â”‚              Correlation Results Dictionary                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              LAYER 8: REPORT GENERATION                         â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚   JSON   â”‚  â”‚   PDF    â”‚  â”‚   HTML   â”‚  â”‚  Graphs  â”‚      â”‚
â”‚  â”‚  Export  â”‚  â”‚  Report  â”‚  â”‚Dashboard â”‚  â”‚  (D3.js) â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜      â”‚
â”‚       â”‚             â”‚             â”‚             â”‚              â”‚
â”‚       â–¼             â–¼             â–¼             â–¼              â”‚
â”‚  Complete      Executive    Interactive    Visual Attack      â”‚
â”‚  Structured    Summary      Metrics &     Path Diagrams       â”‚
â”‚  Data          Tables        Charts                            â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
                  OUTPUT FILES
```

---

## ðŸ”„ Detailed Component Flows

### 1. Ingestion Flow (Layer 1)

```
Scanner Output File
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  File Validation  â”‚ â† Check file exists, readable
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Format Detection  â”‚ â† XML, JSON, or Text
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Parse Content    â”‚ â† Extract vulnerability data
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Create Vuln Obj   â”‚ â† NormalizedVulnerability objects
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Error Handling   â”‚ â† Log errors, continue processing
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
  List[NormalizedVulnerability]
```

**Key Features:**
- Handles malformed data gracefully
- Logs all parsing activities
- Extracts: IP, hostname, port, service, CVE, CVSS, severity
- Generates consistent asset IDs

---

### 2. Normalization Flow (Layer 2)

```
Raw Vulnerabilities (from multiple scanners)
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Group by: Asset + Port + CVE/Config  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ For each group:                       â”‚
â”‚  â€¢ Merge scanner sources              â”‚
â”‚  â€¢ Take highest CVSS                  â”‚
â”‚  â€¢ Take most severe severity          â”‚
â”‚  â€¢ Combine tech stacks                â”‚
â”‚  â€¢ Merge MITRE techniques             â”‚
â”‚  â€¢ OR exploit availability            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ CVE-based Deduplication               â”‚
â”‚  â€¢ Group by Asset + CVE               â”‚
â”‚  â€¢ Merge duplicate CVEs               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
  Normalized Vulnerability List
```

**Conflict Resolution Rules:**
- CVSS: Highest score wins
- Severity: Most severe wins
- Exploit: If any scanner says yes â†’ yes
- Service: Prefer non-"unknown" values
- Timestamps: Use latest

---

### 3. Enrichment Flow (Layer 3)

```
Normalized Vulnerability
        â”‚
        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                                 â”‚
        â–¼                                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  NVD API     â”‚              â”‚  EPSS API        â”‚
â”‚              â”‚              â”‚                  â”‚
â”‚ â€¢ CVE detailsâ”‚              â”‚ â€¢ Exploit prob.  â”‚
â”‚ â€¢ CVSS v3    â”‚              â”‚ â€¢ Percentile     â”‚
â”‚ â€¢ References â”‚              â”‚                  â”‚
â”‚ â€¢ Patches    â”‚              â”‚                  â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                               â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                     â”‚
        â–¼                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ExploitDB    â”‚      â”‚ MITRE ATT&CK     â”‚
â”‚              â”‚      â”‚                  â”‚
â”‚ â€¢ Public     â”‚      â”‚ â€¢ Technique IDs  â”‚
â”‚   exploits   â”‚      â”‚ â€¢ Tactics        â”‚
â”‚ â€¢ Metadata   â”‚      â”‚ â€¢ CWE mapping    â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                       â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
        Enriched Vulnerability
```

**Enrichment Data Added:**
- CVE details from NVD
- Exploit probability (EPSS)
- Public exploit availability
- MITRE ATT&CK techniques
- Patch information
- Attack vector details

---

### 4. Attack Graph Construction Flow (Layer 4)

```
Enriched Vulnerabilities
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 1: Create Asset Nodes          â”‚
â”‚  â€¢ One node per unique asset        â”‚
â”‚  â€¢ Store: IP, hostname, OS, vulns  â”‚
â”‚  â€¢ Mark external accessibility     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 2: Create Privilege Nodes      â”‚
â”‚  â€¢ asset_USER                       â”‚
â”‚  â€¢ asset_ADMIN                      â”‚
â”‚  â€¢ asset_SYSTEM                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 3: Add Vulnerability Edges     â”‚
â”‚  â€¢ Source: ATTACKER or asset        â”‚
â”‚  â€¢ Target: Vulnerable asset         â”‚
â”‚  â€¢ Weight: Based on exploitability  â”‚
â”‚  â€¢ Attributes: CVE, CVSS, EPSS      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 4: Add Reachability Edges      â”‚
â”‚  â€¢ Same network segment             â”‚
â”‚  â€¢ Bidirectional connectivity       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 5: Add Privilege Escalation    â”‚
â”‚  â€¢ USER â†’ ADMIN                     â”‚
â”‚  â€¢ ADMIN â†’ SYSTEM                   â”‚
â”‚  â€¢ Based on LPE vulnerabilities     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 6: Add Lateral Movement        â”‚
â”‚  â€¢ asset_SYSTEM â†’ other_asset       â”‚
â”‚  â€¢ Credential reuse edges           â”‚
â”‚  â€¢ Trust relationships              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
    NetworkX DiGraph
```

**Edge Weight Calculation:**
```python
weight = 10.0  # Base
weight -= (cvss_score / 10.0) * 3
weight -= epss_score * 2
weight -= 2 if exploit_available else 0
weight += privilege_required_factor
weight = max(0.1, weight)  # Ensure positive
```

Lower weight = Easier to exploit

---

### 5. Attack Path Generation Flow (Layer 5)

```
Attack Graph
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Identify Entry Points               â”‚
â”‚  â€¢ ATTACKER node                    â”‚
â”‚  â€¢ Externally accessible assets     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Identify Targets                    â”‚
â”‚  â€¢ High-value assets (CVSS â‰¥ 7)    â”‚
â”‚  â€¢ SYSTEM privilege nodes           â”‚
â”‚  â€¢ Critical infrastructure          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Generate Paths (for each pair)      â”‚
â”‚  â€¢ All simple paths (cutoff=5)     â”‚
â”‚  â€¢ Shortest path (Dijkstra)        â”‚
â”‚  â€¢ Sort by exploitability          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Create AttackPath Objects           â”‚
â”‚  â€¢ Extract steps from node list    â”‚
â”‚  â€¢ Calculate complexity             â”‚
â”‚  â€¢ Calculate impact                 â”‚
â”‚  â€¢ Calculate exploitability         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Classify Paths                      â”‚
â”‚  â€¢ Simple (1 step)                  â”‚
â”‚  â€¢ Chained (2+ steps)               â”‚
â”‚  â€¢ Rank by probability              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
    List[AttackPath]
```

**Exploitability Score Calculation:**
```python
factors = []
for step in path:
    if epss_score:
        factors.append(epss_score * 100)
    if exploit_available:
        factors.append(80)
    if cvss_score:
        factors.append(cvss_score * 10)
    complexity_score = 100 - (complexity * 10)
    factors.append(complexity_score)

exploitability = average(factors)
```

---

### 6. Zero-Day Detection Flow (Layer 6)

#### 6A. ZDES Calculation Flow

```
Asset + Vulnerabilities
        â”‚
        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                                      â”‚
        â–¼                                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Unknown Services â”‚              â”‚ EOL Software     â”‚
â”‚ Score: 0-20      â”‚              â”‚ Score: 0-25      â”‚
â”‚                  â”‚              â”‚                  â”‚
â”‚ â€¢ Count unknown  â”‚              â”‚ â€¢ Check OS       â”‚
â”‚ â€¢ Calculate %    â”‚              â”‚ â€¢ Check services â”‚
â”‚ â€¢ Score = % * 20 â”‚              â”‚ â€¢ Match EOL DB   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                                 â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                           â”‚
        â–¼                           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Unknown Versions â”‚      â”‚ Weak Configs     â”‚
â”‚ Score: 0-15      â”‚      â”‚ Score: 0-10      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                         â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                           â”‚
        â–¼                           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Abnormal Ports   â”‚      â”‚ Unpatched CVEs   â”‚
â”‚ Score: 0-10      â”‚      â”‚ Score: 0-10      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                         â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚ External Exposureâ”‚
              â”‚ Score: 0-10      â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
              Sum All Scores
                       â”‚
                       â–¼
              ZDES (0-100)
```

#### 6B. Anomaly Detection Flow

```
Current Scan + Baseline
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Load Baseline (if exists)           â”‚
â”‚  â€¢ Previous asset states            â”‚
â”‚  â€¢ Port configurations              â”‚
â”‚  â€¢ Service mappings                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Compare Current vs Baseline         â”‚
â”‚                                     â”‚
â”‚ New Ports:                          â”‚
â”‚  current_ports - baseline_ports     â”‚
â”‚                                     â”‚
â”‚ Service Changes:                    â”‚
â”‚  port exists but service changed    â”‚
â”‚                                     â”‚
â”‚ Scanner Disagreements:              â”‚
â”‚  multiple scanners, different svcs  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Generate Anomaly Indicators         â”‚
â”‚  â€¢ Type: anomaly                    â”‚
â”‚  â€¢ Confidence: 0.4-0.9              â”‚
â”‚  â€¢ Severity: LOW/MEDIUM/HIGH        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
  List[ZeroDayIndicator]
```

#### 6C. Behavior Detection Flow

```
Attack Paths + Vulnerabilities
        â”‚
        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                                  â”‚
        â–¼                                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Privilege Escalation â”‚      â”‚ Lateral Movement     â”‚
â”‚ Anomalies            â”‚      â”‚ Patterns             â”‚
â”‚                      â”‚      â”‚                      â”‚
â”‚ â€¢ Count escalations  â”‚      â”‚ â€¢ Track movements    â”‚
â”‚ â€¢ Check path length  â”‚      â”‚ â€¢ Detect frequency   â”‚
â”‚ â€¢ Flag if rapid      â”‚      â”‚ â€¢ Flag unusual       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚                             â”‚
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                           â”‚
        â–¼                           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ RCE Patterns     â”‚      â”‚ Toxic CVE Combos â”‚
â”‚                  â”‚      â”‚                  â”‚
â”‚ â€¢ High CVSS      â”‚      â”‚ â€¢ Multiple high  â”‚
â”‚ â€¢ Network vector â”‚      â”‚   severity CVEs  â”‚
â”‚ â€¢ No CVE ID      â”‚      â”‚ â€¢ Same asset     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                         â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â–¼
        Generate Behavior Indicators
                      â”‚
                      â–¼
          List[ZeroDayIndicator]
```

---

## ðŸ“ˆ Data Flow Examples

### Example 1: Single Vulnerability Journey

```
INPUT: Nmap scan finds Apache 2.4.6 on port 80

1. INGESTION
   NmapParser extracts:
   - IP: 192.168.1.10
   - Port: 80
   - Service: Apache 2.4.6
   - OS: Linux 3.X

2. NORMALIZATION
   Creates NormalizedVulnerability:
   - asset_id: asset_192_168_1_10
   - service_name: http
   - service_version: Apache 2.4.6

3. ENRICHMENT
   NVD finds CVE-2021-41773:
   - CVSS: 9.8 (CRITICAL)
   - Attack Vector: NETWORK
   
   EPSS adds:
   - Exploit Probability: 0.95 (95%)
   
   ExploitDB confirms:
   - Public exploit available
   
   MITRE ATT&CK maps to:
   - T1190: Exploit Public-Facing Application

4. ATTACK GRAPH
   Creates nodes:
   - ATTACKER (entry point)
   - asset_192_168_1_10 (target)
   
   Creates edge:
   - ATTACKER â†’ asset_192_168_1_10
   - Weight: 0.5 (very exploitable)

5. PATH GENERATION
   Generates AttackPath:
   - Entry: ATTACKER
   - Target: asset_192_168_1_10
   - Steps: 1
   - Exploitability: 95.0
   - Type: simple

6. ZERO-DAY DETECTION
   ZDES factors:
   - External exposure: +10
   - Unpatched CVE: +10
   - Total ZDES: 20 (LOW)

7. CORRELATION
   Risk Score:
   - CVSS component: 24.5 (9.8 * 10 * 0.25)
   - EPSS component: 19.0 (0.95 * 100 * 0.20)
   - Exploitability: 20.0 (100% * 0.20)
   - Total: 63.5 (HIGH)

8. REPORTING
   Appears in:
   - JSON: Complete data
   - PDF: High-risk asset table
   - HTML: Critical vulnerability card
   - Graph: Red node with thick edge

OUTPUT: High-priority remediation target identified
```

---

### Example 2: Multi-Stage Attack Path

```
SCENARIO: Attacker compromises web server, escalates privileges, 
          moves laterally to database

1. ATTACK GRAPH CONSTRUCTION
   
   Nodes:
   - ATTACKER
   - webserver (192.168.1.10)
   - webserver_USER
   - webserver_SYSTEM
   - database (192.168.1.20)
   
   Edges:
   - ATTACKER â†’ webserver (CVE-2021-41773, RCE)
   - webserver â†’ webserver_USER (initial access)
   - webserver_USER â†’ webserver_SYSTEM (CVE-2021-3156, sudo)
   - webserver_SYSTEM â†’ database (credential reuse)

2. PATH GENERATION
   
   Path found:
   Step 1: ATTACKER â†’ webserver
     - Exploit: CVE-2021-41773 (Apache RCE)
     - Privilege: USER
     - Technique: T1190
     - Complexity: 0.5
   
   Step 2: webserver_USER â†’ webserver_SYSTEM
     - Exploit: CVE-2021-3156 (sudo heap overflow)
     - Privilege: SYSTEM
     - Technique: T1068
     - Complexity: 2.0
   
   Step 3: webserver_SYSTEM â†’ database
     - Exploit: Credential reuse
     - Privilege: USER
     - Technique: T1021
     - Complexity: 1.0
   
   Total Complexity: 3.5
   Total Impact: 27.5
   Exploitability: 82.3
   Type: chained

3. ZERO-DAY BEHAVIOR DETECTION
   
   Flags:
   - Rapid privilege escalation (2 steps)
   - Lateral movement detected
   - Toxic combination: RCE + LPE

4. CORRELATION
   
   Kill Chain Generated:
   - Stage 1: Initial Access (T1190)
   - Stage 2: Privilege Escalation (T1068)
   - Stage 3: Lateral Movement (T1021)
   - Stage 4: Impact (Database compromise)

5. REPORTING
   
   Critical Path Report:
   - Path ID: uuid-1234
   - Entry: ATTACKER
   - Target: database
   - Steps: 3
   - Criticality: 85.0
   - Recommendation: Patch Apache immediately

OUTPUT: Multi-stage attack chain identified and prioritized
```

---

## ðŸ”§ Technical Implementation Details

### Data Structures

#### NormalizedVulnerability
```python
@dataclass
class NormalizedVulnerability:
    asset_id: str                    # Unique asset identifier
    hostname: Optional[str]          # DNS name
    ip_address: Optional[str]        # IP address
    port: Optional[int]              # Service port
    protocol: Optional[str]          # tcp/udp
    service_name: Optional[str]      # http, ssh, etc.
    service_version: Optional[str]   # Version string
    tech_stack: List[str]            # Technologies used
    os: Optional[str]                # Operating system
    cve_id: Optional[str]            # CVE identifier
    cvss_score: Optional[float]      # 0-10 severity
    severity: Optional[str]          # CRITICAL/HIGH/MEDIUM/LOW
    cwe: Optional[str]               # Weakness type
    misconfiguration: Optional[str]  # Config issues
    exploit_available: bool          # Public exploit exists
    epss_score: Optional[float]      # Exploit probability
    attack_vector: Optional[str]     # NETWORK/LOCAL/etc.
    privilege_required: Optional[str]# NONE/LOW/HIGH
    network_reachability: Optional[str]
    scanner_source: str              # Which scanner found it
    timestamp: datetime              # When discovered
    exploit_metadata: Dict           # Additional exploit info
    patch_available: bool            # Patch exists
    mitre_techniques: List[str]      # ATT&CK techniques
```

#### AttackPath
```python
@dataclass
class AttackPath:
    path_id: str                     # Unique path ID
    steps: List[AttackPathStep]      # Sequence of exploits
    total_complexity: float          # Sum of step complexities
    total_impact: float              # Cumulative impact
    exploitability_score: float      # 0-100 likelihood
    path_type: str                   # 'simple' or 'chained'
    entry_point: str                 # Starting node
    target: str                      # Destination node
```

#### ZeroDayIndicator
```python
@dataclass
class ZeroDayIndicator:
    asset_id: str                    # Affected asset
    indicator_type: str              # exposure/anomaly/behavior
    description: str                 # Human-readable description
    confidence: float                # 0-1 confidence level
    severity: str                    # Impact severity
    details: Dict                    # Additional context
    timestamp: datetime              # When detected
```

---

### Algorithms

#### 1. Edge Weight Calculation
```python
def calculate_edge_weight(vulnerability):
    weight = 10.0  # Base complexity
    
    # Lower weight = easier to exploit
    if vulnerability.cvss_score:
        weight -= (vulnerability.cvss_score / 10.0) * 3
    
    if vulnerability.epss_score:
        weight -= vulnerability.epss_score * 2
    
    if vulnerability.exploit_available:
        weight -= 2
    
    # Attack vector affects difficulty
    if vulnerability.attack_vector == 'NETWORK':
        weight -= 1  # Easier
    elif vulnerability.attack_vector == 'LOCAL':
        weight += 1  # Harder
    
    # Privilege requirements
    if vulnerability.privilege_required == 'NONE':
        weight -= 1
    elif vulnerability.privilege_required == 'HIGH':
        weight += 2
    
    return max(0.1, weight)  # Ensure positive
```

#### 2. Exploitability Score
```python
def calculate_exploitability(attack_path):
    factors = []
    
    for step in attack_path.steps:
        vuln = step.vulnerability
        
        # EPSS score (0-1) â†’ 0-100
        if vuln.epss_score:
            factors.append(vuln.epss_score * 100)
        
        # Exploit availability
        if vuln.exploit_available:
            factors.append(80)
        
        # CVSS score (0-10) â†’ 0-100
        if vuln.cvss_score:
            factors.append(vuln.cvss_score * 10)
        
        # Complexity (inverse)
        complexity_score = max(0, 100 - (step.complexity * 10))
        factors.append(complexity_score)
    
    return sum(factors) / len(factors) if factors else 50.0
```

#### 3. ZDES Calculation
```python
def calculate_zdes(asset, vulnerabilities):
    score = 0.0
    
    # Unknown services (0-20)
    unknown_count = sum(1 for v in vulnerabilities 
                       if v.service_name in ['unknown', None])
    score += (unknown_count / len(vulnerabilities)) * 20
    
    # EOL software (0-25)
    if is_eol(asset.os):
        score += 15
    for vuln in vulnerabilities:
        if is_eol(vuln.service_version):
            score += 5
            break
    
    # Unknown versions (0-15)
    no_version = sum(1 for v in vulnerabilities 
                    if not v.service_version)
    score += (no_version / len(vulnerabilities)) * 15
    
    # Weak configs (0-10)
    weak_configs = sum(1 for v in vulnerabilities 
                      if 'weak' in (v.misconfiguration or '').lower())
    score += min(10, weak_configs * 2)
    
    # Abnormal ports (0-10)
    abnormal = sum(1 for v in vulnerabilities 
                  if is_abnormal_port(v.service_name, v.port))
    score += min(10, abnormal * 2)
    
    # Unpatched (0-10)
    unpatched = sum(1 for v in vulnerabilities 
                   if v.cve_id and not v.patch_available)
    score += (unpatched / len(vulnerabilities)) * 10
    
    # External exposure (0-10)
    if asset.is_external:
        score += 5
        external_vulns = sum(1 for v in vulnerabilities 
                           if v.attack_vector == 'NETWORK' 
                           and v.cvss_score >= 7.0)
        score += min(5, external_vulns)
    
    return min(100.0, score)
```

#### 4. Risk Score Calculation
```python
def calculate_risk_score(asset, vulns, paths, zd_indicators, weights):
    # CVSS component
    cvss_scores = [v.cvss_score for v in vulns if v.cvss_score]
    cvss_component = (mean(cvss_scores) * 10) if cvss_scores else 0
    
    # EPSS component
    epss_scores = [v.epss_score for v in vulns if v.epss_score]
    epss_component = (mean(epss_scores) * 100) if epss_scores else 0
    
    # Exploitability component
    exploit_count = sum(1 for v in vulns if v.exploit_available)
    exploitability = (exploit_count / len(vulns)) * 100 if vulns else 0
    
    # Chain potential component
    chain_component = min(100, len(paths) * 10)
    
    # ZDES component
    zdes_component = asset.zdes_score
    
    # Path impact component
    if paths:
        path_impacts = [p.total_impact for p in paths]
        path_component = min(100, mean(path_impacts) * 10)
    else:
        path_component = 0
    
    # Weighted sum
    risk_score = (
        cvss_component * weights['cvss'] +
        epss_component * weights['epss'] +
        exploitability * weights['exploitability'] +
        chain_component * weights['chain_potential'] +
        zdes_component * weights['zdes'] +
        path_component * weights['path_impact']
    )
    
    return min(100.0, risk_score)
```

---

## ðŸ“Š Output Formats

### 1. JSON Output Structure

```json
{
  "metadata": {
    "export_date": "2024-11-29T18:00:00",
    "report_type": "Complete Analysis"
  },
  "summary": {
    "total_vulnerabilities": 247,
    "total_attack_paths": 18,
    "total_zero_day_indicators": 12,
    "network_risk_score": 73.5
  },
  "vulnerabilities": [
    {
      "asset_id": "asset_192_168_1_10",
      "ip_address": "192.168.1.10",
      "port": 80,
      "service_name": "http",
      "cve_id": "CVE-2021-41773",
      "cvss_score": 9.8,
      "severity": "CRITICAL",
      "epss_score": 0.95,
      "exploit_available": true,
      "mitre_techniques": ["T1190"]
    }
  ],
  "attack_paths": [
    {
      "path_id": "uuid-1234",
      "entry_point": "ATTACKER",
      "target": "asset_192_168_1_10",
      "steps": [
        {
          "source_asset": "ATTACKER",
          "target_asset": "asset_192_168_1_10",
          "exploit_used": "CVE-2021-41773",
          "privilege_gained": "USER",
          "technique_id": "T1190",
          "impact": "CRITICAL"
        }
      ],
      "exploitability_score": 95.0,
      "path_type": "simple"
    }
  ],
  "correlation_analysis": {
    "high_risk_assets": [
      {
        "asset_id": "asset_192_168_1_10",
        "risk_score": 82.3,
        "risk_level": "CRITICAL",
        "vulnerability_count": 15,
        "attack_path_count": 8
      }
    ],
    "critical_paths": [...],
    "zero_day_exposure_map": {...}
  }
}
```

### 2. PDF Report Sections

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         TITLE PAGE                  â”‚
â”‚  â€¢ Report title                     â”‚
â”‚  â€¢ Generation date                  â”‚
â”‚  â€¢ Key metrics table                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      EXECUTIVE SUMMARY              â”‚
â”‚  â€¢ Overall risk assessment          â”‚
â”‚  â€¢ Network risk score               â”‚
â”‚  â€¢ High-level statistics            â”‚
â”‚  â€¢ Key findings                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      HIGH-RISK ASSETS               â”‚
â”‚  â€¢ Asset table (top 10)             â”‚
â”‚  â€¢ Risk scores                      â”‚
â”‚  â€¢ Vulnerability counts             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      CRITICAL ATTACK PATHS          â”‚
â”‚  â€¢ Path descriptions                â”‚
â”‚  â€¢ Exploitability scores            â”‚
â”‚  â€¢ Impact assessments               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      ZERO-DAY ANALYSIS              â”‚
â”‚  â€¢ ZDES scores                      â”‚
â”‚  â€¢ Anomaly indicators               â”‚
â”‚  â€¢ Behavior detections              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      RECOMMENDATIONS                â”‚
â”‚  â€¢ Prioritized remediation          â”‚
â”‚  â€¢ Patch guidance                   â”‚
â”‚  â€¢ Security controls                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3. HTML Dashboard Components

```html
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         HEADER                      â”‚
â”‚  â€¢ Title and logo                   â”‚
â”‚  â€¢ Generation timestamp             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      METRICS CARDS                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚ Risk â”‚ â”‚Vulns â”‚ â”‚Paths â”‚        â”‚
â”‚  â”‚ 73.5 â”‚ â”‚ 247  â”‚ â”‚  18  â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”˜        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      HIGH-RISK ASSETS TABLE         â”‚
â”‚  â€¢ Sortable columns                 â”‚
â”‚  â€¢ Color-coded risk levels          â”‚
â”‚  â€¢ Interactive filters              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      CRITICAL PATHS TABLE           â”‚
â”‚  â€¢ Path details                     â”‚
â”‚  â€¢ Exploitability bars              â”‚
â”‚  â€¢ Expandable steps                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      CHARTS (Plotly)                â”‚
â”‚  â€¢ Risk distribution                â”‚
â”‚  â€¢ Vulnerability trends             â”‚
â”‚  â€¢ Attack path complexity           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4. Graph Visualizations

**Static PNG (Matplotlib):**
- Nodes: Assets (blue), Privileges (green), Entry points (red)
- Edges: Directed arrows with weights
- Labels: Asset IDs
- Layout: Spring layout algorithm

**Interactive D3.js:**
- Draggable nodes
- Zoom and pan
- Hover tooltips
- Click for details
- Force-directed layout

---

## ðŸŽ¯ Use Case Scenarios

### Scenario 1: Penetration Testing

**Objective:** Identify attack paths before red team engagement

**Flow:**
```
1. Run vulnerability scans (Nmap, Nuclei, Nessus)
2. Feed results to engine
3. Review generated attack paths
4. Prioritize by exploitability
5. Plan attack campaign
6. Execute with highest probability paths
```

**Output Used:**
- Attack path JSON for automation
- HTML dashboard for planning
- Graph visualization for strategy

---

### Scenario 2: Vulnerability Management

**Objective:** Prioritize patching based on real risk

**Flow:**
```
1. Weekly automated scans
2. Engine processes results
3. Risk scores calculated
4. High-risk assets identified
5. Tickets created for top 10
6. Track remediation progress
```

**Output Used:**
- JSON for ticketing system integration
- PDF reports for management
- Risk scores for prioritization

---

### Scenario 3: Security Operations

**Objective:** Continuous monitoring and anomaly detection

**Flow:**
```
1. Daily scans run automatically
2. Engine compares to baseline
3. Anomalies detected
4. Alerts sent for new risks
5. SOC investigates indicators
6. Update baseline after validation
```

**Output Used:**
- Zero-day indicators for alerts
- Anomaly detection for monitoring
- Trend analysis from historical data

---

### Scenario 4: Compliance Reporting

**Objective:** Demonstrate security posture to auditors

**Flow:**
```
1. Quarterly comprehensive scans
2. Engine generates full analysis
3. PDF report created
4. Executive summary prepared
5. Present to stakeholders
6. Track improvements over time
```

**Output Used:**
- PDF reports for documentation
- HTML dashboard for presentations
- Metrics for compliance tracking

---

### Scenario 5: Red Team Operations

**Objective:** Simulate advanced persistent threat

**Flow:**
```
1. Reconnaissance scans
2. Engine identifies attack chains
3. Multi-stage paths analyzed
4. Kill chains generated
5. Execute staged attack
6. Document findings
```

**Output Used:**
- Chained attack paths
- Kill chain sequences
- MITRE ATT&CK mappings
- Lateral movement paths

---
